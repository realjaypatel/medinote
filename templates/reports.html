{% extends "base.html" %}
{% block content %}

<div class="d-flex justify-content-between align-items-center mb-3">
  <h4 class="mb-0">All Reports</h4>
  <button onclick="window.print()" class="btn btn-outline-secondary btn-sm d-print-none">
    üñ®Ô∏è Print
  </button>
</div>

<div class="table-responsive">
  <table class="table table-striped table-hover align-middle">
    <thead class="table-light">
      <tr>
        <th style="width: 20%;">Title</th>
        <th style="width: 30%;">Patient</th>
        <th style="width: 50%;">Report</th>
      </tr>
    </thead>
    <tbody>
      {% for report in reports %}
      <tr>
        <td>
          <a href="{{ url_for('report_detail', report_id=report.id) }}" class="text-decoration-none">
            {{ report.title }}
          </a>
        </td>
        <td>
          {% set patient = patients.get(report.patient_id) %}
          {% if patient %}
            <a href="{{ url_for('patient_profile', patient_id=patient.id) }}" class="text-decoration-none">
              {{ patient.name }} ({{ patient.age }}, {{ patient.phone }})
            </a>
          {% else %}
            <span class="text-muted">Unknown</span>
          {% endif %}
        </td>
        <td class="text-truncate" style="max-width: 400px;">
          {{ report.report_text }}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<style>
/* Make long report text truncate with ellipsis */
.text-truncate {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Print-friendly styles */
@media print {
  .d-print-none {
    display: none !important;
  }
  body {
    font-size: 12pt;
  }
  a {
    text-decoration: none;
    color: black;
  }
  table {
    border: 1px solid #000;
  }
  th, td {
    border: 1px solid #000;
    padding: 6px !important;
  }
}
</style>

{% endblock %}
